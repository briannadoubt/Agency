---
owner: bri
agent_flow: null
agent_status: done
branch: implement/7.5-validation-and-e2e-tests
risk: normal
review: not-requested
---

# 7.5 Validation & E2E Tests

Summary:
Add validation, safeguards, and end-to-end tests for the roadmap-driven initialization flow across both existing and new project directories.

Acceptance Criteria:
- [x] ConventionsValidator extensions
- [x] E2E for existing/new dirs
- [x] Extend ConventionsValidator (or new checks) to cover ROADMAP schema, ARCHITECTURE.md presence, and generated card correctness
- [x] Add integration tests that run the initializer in a temp empty dir and a populated dir with existing cards
- [x] Ensure flows are idempotent and report pending/manual actions instead of overwriting without consent
- [x] Document failure modes and recovery steps (e.g., stale roadmap, schema mismatch, partial writes)
- [x] Wire tests into CI/make targets used before PR completion

Notes:
- Reuse existing testing harnesses where possible; keep runtime low
- Include fixtures for sample ROADMAP.md and expected outputs

Risks, Assumptions, Guardrails:
- Idempotency: regeneration of ROADMAP.md, cards, and ARCHITECTURE.md must be repeatable; prefer diff-safe writes and backups.
- Non-destructive defaults: initializer refuses to overwrite existing files without explicit flags; dry-run previews required before writes.
- Validation-first: schema and ConventionsValidator checks gate writes; partial failures surface actionable recovery steps.
- Compatibility: preserve manual History entries and frontmatter fields when re-materializing; honor feature flags to disable auto-materialization in sensitive repos.
- Git hygiene: flows must respect dirty worktrees and avoid committing artifacts; interactive prompts available but scriptable flags remain.

Validation Strategy & Success Measures:
- Unit coverage for roadmap parser/generator (7.1), initializer orchestration (7.2), card materializer (7.3), architecture builder (7.4), and validators.
- End-to-end tests that run initializer in empty and pre-populated directories, asserting idempotent reruns and clean ConventionsValidator output.
- Success criteria: generated roadmap/cards/architecture pass validation, no unintended overwrites in existing repos, and bootstrap completes with clear logs and recovery guidance.

History:
- 2025-11-29: Card created for validation and E2E coverage.
- 2025-11-29: Added shared risks, guardrails, and validation strategy from phase plan.
- 2025-11-29: Started work on validation and E2E tests.
- 2025-11-29: Completed validation extensions, E2E coverage, and documentation; tests passing.
- 2025-11-29: Implemented validation coverage, integration tests, docs, and full test run.
