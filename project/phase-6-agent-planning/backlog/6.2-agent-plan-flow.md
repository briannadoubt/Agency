---
owner: bri
agent_flow: null
agent_status: idle
branch: null
risk: normal
review: not-requested
---

# 6.2 Agent Plan Flow & Runner Wiring

Summary:
Introduce a dedicated planning flow (`AgentFlow.plan`) and wire the runner to invoke the CLI backend, stream logs/progress, and refresh the project snapshot once a phase is created.

Acceptance Criteria:
- [ ] Add `AgentFlow.plan` (or equivalent) and expose it in the runner state machine
- [ ] Register a `.cli` backend that shells out to the new phase-scaffolding command with proper args
- [ ] Live log/progress streaming works with the new flow (queued → running → succeeded/failed/canceled)
- [ ] On success, loader rescans project and shows the new phase without relaunching the app
- [ ] History entry on the plan artifact references runID and flow

Notes:
- Keep cancellation propagation consistent with existing flows; ensure cleanup of child tasks/processes.
- Consider feature-flagging the new flow while MCP work is pending.

Alignment:
- Provides end-to-end agent-driven phase creation using existing UI/log plumbing.

History:
- 2025-11-28: Card drafted for Phase 6 planning.
