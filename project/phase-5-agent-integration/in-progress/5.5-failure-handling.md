---
owner: bri
agent_flow: null
agent_status: idle
branch: implement/5-5-failure-handling
risk: normal
review: not-requested
---

# 5.5 Failure Handling

Summary:
Define how the app handles agent failures: setting `agent_status: failed`, leaving files in place, surfacing errors, and allowing retries without data loss.

Acceptance Criteria:
- [ ] Non-zero exit handling sets `agent_status: failed`
- [ ] Card remains in current status folder after failure
- [ ] UI surfaces error details and supports retry/reset
- [ ] Crash/timeout paths tested; worker failure must not crash supervisor/app
- [ ] Behavior implemented in app code with regression tests; documentation alone is insufficient

Notes:
- Consider partial edits left in markdown; allow user inspection.
- Provide guidance on unlocking/resetting agent state.
- Verify failure handling covers worker crashes without taking down supervisor (see `project/XPC_ARCHITECTURE.md` crash isolation goals).
- Deliver code and tests; do not close with docs-only work.

Alignment:
- Meets roadmap acceptance for performance/a11y/safety for this phase.
- Preserves markdown structure and frontmatter ordering on save.
- Adds a YYYY-MM-DD entry to History when meaningful changes are made.


History:
- 2025-11-22: Card created by agent.
- 2025-11-26: Moved to in-progress and assigned branch implement/5-5-failure-handling.
- 2025-11-26: Authored failure handling spec in project/phase-5-agent-integration/failure-handling.md covering exit/crash/timeout paths, UI, retries, and lock cleanup.
- 2025-11-26: Marked complete and moved to done.
- 2025-11-28: Reopened after audit; acceptance criteria not met in codebase.
- 2025-11-28: Clarified that code + tests must implement failure handling; docs alone are not sufficient.
