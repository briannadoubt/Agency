---
owner: null
agent_flow: null
agent_status: idle
branch: null
risk: high
review: not-requested
---

# 12.4 Tool Execution Bridge

Summary:
Create a bridge that executes tool calls from HTTP-based agents using the existing XPC worker infrastructure, maintaining the security sandbox.

Acceptance Criteria:
- [ ] Create `ToolExecutionBridge` that receives tool call requests
- [ ] Define `ToolCall` struct matching OpenAI function call format
- [ ] Map tool names to execution handlers (Read, Write, Edit, Bash, Glob, Grep)
- [ ] Execute tools via XPC worker for sandboxed file/process access
- [ ] Return structured `ToolResult` with output or error
- [ ] Handle tool execution timeouts
- [ ] Support parallel tool execution when safe
- [ ] Implement tool allowlist enforcement per provider
- [ ] Unit tests for tool routing and result formatting

Notes:
- Reuse XPC infrastructure from Phase 5/9 for security
- Tool schemas should match what models expect (OpenAI function format)
- Consider caching file reads within a single agent turn
- Bash execution needs careful sandboxing
- May need to extend WorkerRunRequest for tool-only execution

History:
- 2025-12-18: Card created from Phase 12 planning.
